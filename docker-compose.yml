version: "2"

services:
  app0: &app
    build: example_golang/
    ports:
    - 8080
    networks:
    - ws
  app1:
    <<: *app
  app2:
    <<: *app
  app3:
    <<: *app
  prometheus:
    image: prom/prometheus
    ports:
    - '9090:9090'
    volumes:
    - './config:/etc/prometheus'
    - './data/prometheus:/prometheus'
    networks:
    - ws
  cadvisor:
    image: google/cadvisor
    privileged: true
    ports:
    - 8080
    volumes:
    - "/:/rootfs:ro"
    - "/var/run:/var/run:rw"
    - "/sys:/sys:ro"
    - "/var/lib/docker/:/var/lib/docker:ro"
    networks:
    - ws
  grafana:
    image: grafana/grafana
    restart: always
    ports:
    - 3000:3000
    networks:
    - ws

networks:
  ws:
    driver: bridge
